var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in b||(b[f]={});b=b[f]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,b,d){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var c=[],e=a[Symbol.iterator];if("function"==typeof e)for(a=e.call(a);!(e=a.next()).done;)c.push(b.call(d,e.value));else{e=a.length;for(var g=0;g<e;g++)c.push(b.call(d,a[g]))}return c}},"es6","es3");
var tabInfo=null,background=chrome.extension.getBackgroundPage(),codeInserted=!1,Main=function(){this.overlayOpen=!1;this.activeTool={id:"paint-brush"};this.toolInfo={paintBrush:{color:"#FFFF00",defaultColor:"#FFFF00",size:5,opacity:1},eraser:{size:5}}};Main.prototype.init=function(){this.attachHandlers()};Main.prototype.reload=function(a){this.toolInfo=this.activeTool=null;for(var c in a)this[c]=a[c];console.log(this);this.attachHandlers();this.reloadValues()};
Main.prototype.attachHandlers=function(){var a=document.querySelector("#switcher");a.addEventListener("click",function(){a.classList.contains("off")?(a.classList.remove("off"),a.classList.add("on"),background.popupObjects[tabInfo.id]=this,codeInserted?chrome.tabs.executeScript(tabInfo.id,{code:"insertCanvasDrawContent()"}):(chrome.tabs.insertCSS({file:chrome.extension.getURL("/content-scripts/css/canvas-draw.min.css")}),chrome.tabs.executeScript({file:chrome.extension.getURL("/content-scripts/js/canvas-draw.min.js")}),
codeInserted=!0),this.overlayOpen=!0):a.classList.contains("on")&&(a.classList.remove("on"),a.classList.add("off"),chrome.tabs.executeScript(tabInfo.id,{code:"removeCanvasDrawContent()"}),this.overlayOpen=!0)}.bind(this,a));Array.from(document.querySelectorAll(".tab-title.tool")).forEach(function(a){a.addEventListener("click",this.toolClickHandler.bind(this,a))},this);Array.from(document.querySelectorAll(".tab-content.active .color")).forEach(function(a){a.addEventListener("click",this.colorClickHandler.bind(this,
a))},this);Array.from(document.querySelectorAll(".tab-content.active input.size-range, .tab-content.active input.opacity-range")).forEach(function(a){a.addEventListener("change",this.rangeHandler.bind(this,a))},this)};
Main.prototype.reloadValues=function(){this.overlayOpen&&(document.querySelector("#switcher").classList.remove("off"),document.querySelector("#switcher").classList.add("on"));var a="[data-tool-id\x3d'"+this.activeTool.id+"']",c=document.querySelector(".tab-title"+a);this.toolClickHandler(c);if("paint-brush"===this.activeTool.id){c=document.querySelector(".tab-content"+a+" .color[data-color-code\x3d'"+this.toolInfo.paintBrush.color+"']");var b=document.querySelector(".tab-content"+a+" .size-range");
a=document.querySelector(".tab-content"+a+" .opacity-range");b.value=this.toolInfo.paintBrush.size;a.value=100-100*this.toolInfo.paintBrush.opacity;this.colorClickHandler(c);this.rangeHandler(b);this.rangeHandler(a)}};Main.prototype.toolClickHandler=function(a){if(!a.classList.contains("active")){var c=a.dataset.toolId;this.disableAllTools();a.classList.add("active");document.querySelector(".tab-content[data-tool-id\x3d'"+c+"']").classList.add("active");this.activeTool.id=c}};
Main.prototype.colorClickHandler=function(a){if(!a.classList.contains("active")){var c=a.parentElement.parentElement,b=c.dataset.toolId,d=a.title.toLowerCase();this.disableAllColors(b);a.classList.add("active");"paint-brush"===b&&(this.toolInfo.paintBrush.color=a.dataset.colorCode);c.dataset.toolColor=d;document.querySelector(".tab-title[data-tool-id\x3d'"+b+"']").dataset.toolColor=d}};
Main.prototype.rangeHandler=function(a){var c=a.dataset.toolId,b=null,d=null;a.classList.contains("size-range")?(b=parseFloat(a.value),d="size",a.nextElementSibling.innerHTML=b+"px"):a.classList.contains("opacity-range")&&(d="opacity",b=(100-parseFloat(a.value))/100,0<b&&1>b?a.nextElementSibling.innerHTML=parseFloat(a.value)+"%":0==b?a.nextElementSibling.innerHTML="100%":1==b&&(a.nextElementSibling.innerHTML="0%"));"paint-brush"===c&&null!=b?"size"===d?this.toolInfo.paintBrush.size=b:"opacity"===
d&&(this.toolInfo.paintBrush.opacity=b):"eraser"===c&&"size"===d&&null!=b&&(this.toolInfo.eraser.size=b)};Main.prototype.disableAllTools=function(){Array.from(document.querySelectorAll(".tab-title.active, .tab-content.active")).forEach(function(a){a.classList.remove("active")})};Main.prototype.disableAllColors=function(a){Array.from(document.querySelectorAll(".tab-content[data-tool-id\x3d'"+a+"'] .color.active")).forEach(function(a){a.classList.remove("active")},this)};var object=new Main;
window.onunload=function(){background.popupObjects[tabInfo.id]=object};window.onload=function(){chrome.tabs.query({active:!0},function(a){tabInfo=a=a[0];chrome.runtime.sendMessage({message:"init-object",tabId:a.id},function(a){console.log(a);"do-it-yourself"!==a.data?(console.log(a.data),object.reload(a.data)):object.init()})})};