var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in b||(b[f]={});b=b[f]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,b,d){$jscomp.initSymbolIterator();b=null!=b?b:function(a){return a};var c=[],e=a[Symbol.iterator];if("function"==typeof e)for(a=e.call(a);!(e=a.next()).done;)c.push(b.call(d,e.value));else{e=a.length;for(var g=0;g<e;g++)c.push(b.call(d,a[g]))}return c}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,b,d){var c=this.length||0;0>b&&(b=Math.max(0,c+b));if(null==d||d>c)d=c;d=Number(d);0>d&&(d=Math.max(0,c+d));for(b=Number(b||0);b<d;b++)this[b]=a;return this}},"es6","es3");var drawEnabled=!1,activeIcon={},canvas={},Highlightor=function(){};
Highlightor.prototype.insertIcons=function(){document.querySelector("img#highlighter.highlighter-icon").src=EXTENSIONPATH+"icons/highlighter-32.png";document.querySelector("img#eraser.highlighter-icon").src=EXTENSIONPATH+"icons/eraser-32.png"};
Highlightor.prototype.attachHandlers=function(){Array.from(document.querySelectorAll("#highlighter-overlay .icon-container")).forEach(function(a){a.addEventListener("click",iconClickHandler)});document.querySelector("#highlighter-overlay #close-overlay").addEventListener("click",function(){this.parentElement.style.display="none";document.querySelector("#highlighter-overlay #canvas-container").className="expanded";drawEnabled=!0});document.querySelector("#highlighter-overlay #confirm-overlay").addEventListener("click",
function(){this.parentNode.parentElement.style.display="none";document.querySelector("#highlighter-overlay #canvas-container").className="expanded";drawEnabled=!0})};Highlightor.prototype.insertOverlay=function(){var a=new XMLHttpRequest;a.open("GET",EXTENSIONPATH+"content-scripts/html/highlight.html",!0);a.overrideMimeType("text/plain; charset\x3dutf-8");a.send();a.onreadystatechange=function(){if(4===a.readyState&&200==a.status||0==a.status)document.body.innerHTML+=a.responseText}};
Highlightor.prototype.closeOverlay=function(){document.getElementById("highlighter-overlay").remove()};
function iconClickHandler(){var a=this.firstElementChild;"highlighter"===a.id?this.classList.contains("active")?(a.src=EXTENSIONPATH+"icons/highlighter-32.png",this.classList.remove("active"),activeIcon={}):(disableAllIcons(),activeIcon={id:"highlighter",object:a},this.classList.add("active"),a.src=EXTENSIONPATH+"icons/highlighter-32_yellow.png",document.querySelector("#highlighter-overlay canvas").style.cursor="url("+EXTENSIONPATH+"icons/highlighter-cursor-16.png), pointer"):"eraser"===a.id&&(this.classList.contains("active")?
(this.classList.remove("active"),a.src=EXTENSIONPATH+"icons/eraser-32.png",activeIcon={}):(activeIcon={id:"eraser",object:a},disableAllIcons(),this.classList.add("active"),a.src=EXTENSIONPATH+"icons/eraser-32_red.png",document.querySelector("#highlighter-overlay canvas").style.cursor="url("+EXTENSIONPATH+"icons/eraser-cursor-16.png), pointer"));return!0}
function drawHighlighter(a){drawEnabled&&"highlighter"==activeIcon.id&&(canvas.context.beginPath(),canvas.context.arc(a.clientX-canvas.posX,a.clientY,5,0,2*Math.PI,!1),canvas.context.fillStyle="#ff0000",canvas.context.fill())}
function disableAllIcons(){activeIcon={};document.querySelector("#highlighter-overlay canvas").style.cursor="default";Array.from(document.querySelectorAll("#highlighter-overlay #controls .icon-container.active")).forEach(function(a){a.classList.remove("active");a.firstElementChild.src=EXTENSIONPATH+"icons/"+a.firstElementChild.id+"-32.png"})}var highlightorObj=new Highlightor;
function insertHighlighterContent(){highlightorObj.insertOverlay();setTimeout(function(){highlightorObj.insertIcons();highlightorObj.attachHandlers();canvas.element=document.querySelector("#highlighter-overlay #canvas-drawing");canvas.context=canvas.element.getContext("2d");canvas.posX=parseInt(canvas.element.offsetLeft,10);canvas.posY=parseInt(canvas.element.offsetTop,10);canvas.element.addEventListener("mousedown",drawHighlighter)},750)}
function removeHighlighterContent(){highlightorObj.closeOverlay()}function handleContent(a){a.handleOverlay?null==document.getElementById("highlighter-overlay")&&insertHighlighterContent():"undefined"!==typeof document.getElementById("highlighter-overlay")&&null!=document.getElementById("highlighter-overlay")&&removeHighlighterContent()}browser.runtime.onMessage.addListener(handleContent);insertHighlighterContent();